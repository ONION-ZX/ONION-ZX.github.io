<!DOCTYPE html>



  


<html class="theme-next pisces use-motion" lang="">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<meta name="theme-color" content="#222">



  
  
    
    
  <script src="/lib/pace/pace.min.js?v=1.0.2"></script>
  <link href="/lib/pace/pace-theme-flash.min.css?v=1.0.2" rel="stylesheet">







<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css" />


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.4">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.4" color="#222">





  <meta name="keywords" content="Hexo, NexT" />










<meta name="description" content="When loading a script on an HTML page, you need to be careful not to harm the loading performance of the page. Depending on where and how you add your scripts to an HTML page will influence the loadi">
<meta property="og:type" content="article">
<meta property="og:title" content="è¯‘-ä½¿ç”¨asyncå’Œdeferæœ‰æ•ˆåœ°åŠ è½½JS">
<meta property="og:url" content="http://yoursite.com/2019/03/28/translate01-Efficiency load JS/index.html">
<meta property="og:site_name" content="OnionÂ·Space">
<meta property="og:description" content="When loading a script on an HTML page, you need to be careful not to harm the loading performance of the page. Depending on where and how you add your scripts to an HTML page will influence the loadi">
<meta property="og:locale" content="default">
<meta property="og:image" content="https://ws3.sinaimg.cn/large/005BYqpgly1g1jjbf73s0j30vh06wgll.jpg">
<meta property="og:image" content="https://ws3.sinaimg.cn/large/005BYqpgly1g1jjbf73s0j30vh06wgll.jpg">
<meta property="og:image" content="https://ws3.sinaimg.cn/large/005BYqpgly1g1jjprl8bij30vg06v0sp.jpg">
<meta property="og:image" content="https://ws3.sinaimg.cn/large/005BYqpgly1g1jk0cqyorj30vh06z0so.jpg">
<meta property="og:updated_time" content="2019-03-29T08:23:12.806Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="è¯‘-ä½¿ç”¨asyncå’Œdeferæœ‰æ•ˆåœ°åŠ è½½JS">
<meta name="twitter:description" content="When loading a script on an HTML page, you need to be careful not to harm the loading performance of the page. Depending on where and how you add your scripts to an HTML page will influence the loadi">
<meta name="twitter:image" content="https://ws3.sinaimg.cn/large/005BYqpgly1g1jjbf73s0j30vh06wgll.jpg">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Pisces',
    version: '5.1.4',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":true,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: 'Author'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://yoursite.com/2019/03/28/translate01-Efficiency load JS/"/>





  <title>è¯‘-ä½¿ç”¨asyncå’Œdeferæœ‰æ•ˆåœ°åŠ è½½JS | OnionÂ·Space</title>
  








</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="default">

  
  
    
  

  <div class="container sidebar-position-left page-post-detail">
    <div class="headband"></div>
    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">OnionÂ·Space</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle"></p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            Home
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br />
            
            About
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            Tags
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br />
            
            Categories
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            Archives
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/03/28/translate01-Efficiency load JS/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="onion">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="https://avatars0.githubusercontent.com/u/32869438?s=460&v=4">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="OnionÂ·Space">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">è¯‘-ä½¿ç”¨asyncå’Œdeferæœ‰æ•ˆåœ°åŠ è½½JS</h1>
        

        <div class="post-meta">
        
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2019-03-28T17:58:08+08:00">
                2019-03-28
              </time>
            

            
              <span class="post-meta-divider">|</span>
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-check-o"></i>
              </span>
              
                <span class="post-meta-item-text">Post modified&#58;</span>
              
              <time title="Post modified" itemprop="dateModified" datetime="2019-03-29T16:23:12+08:00">
                2019-03-29
              </time>
            
          </span>

          

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/æŠ€æœ¯/" itemprop="url" rel="index">
                    <span itemprop="name">æŠ€æœ¯</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2019/03/28/translate01-Efficiency load JS/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count valine-comment-count" data-xid="/2019/03/28/translate01-Efficiency load JS/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        <blockquote>
<p>When loading a script on an HTML page, you need to be careful not to harm the loading performance of the page. Depending on where and how you add your scripts to an HTML page will influence the loading time.</p>
</blockquote>
<blockquote>
<p>å°†è„šæœ¬æ·»åŠ åˆ°HTMLé¡µé¢çš„ä½ç½®å’Œæ–¹å¼å°†å½±å“åŠ è½½æ—¶é—´ï¼Œæ‰€ä»¥ï¼ŒåŠ è½½è„šæœ¬æ—¶ï¼Œéœ€è¦æ³¨æ„ä¸è¦å½±å“åˆ°é¡µé¢çš„åŠ è½½æ€§èƒ½ã€‚</p>
</blockquote>
<p>When loading a script on an HTML page, you need to be careful not to harm the loading performance of the page.</p>
<p>åœ¨HTMLé¡µé¢ä¸­åŠ è½½è„šæœ¬æ—¶ï¼Œéœ€è¦æ³¨æ„ä¸è¦å½±å“åˆ°é¡µé¢çš„åŠ è½½æ€§èƒ½ã€‚</p>
<p>A script is traditionally included in the page in this way:</p>
<p>é€šå¸¸ä½¿ç”¨è¿™ç§æ–¹å¼åœ¨é¡µé¢ä¸­æ·»åŠ è„šæœ¬ï¼š<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;script src=<span class="string">"script.js"</span>&gt;<span class="xml"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br></pre></td></tr></table></figure></p>
<p>whenever the HTML parser finds this line, a request will be made to fetch the script, and the script is executed.</p>
<p>æ¯å½“HTMLè§£æå™¨æ‰¾åˆ°è¯¥è¡Œæ—¶ï¼Œå°†å‘å‡ºä¸€ä¸ªè·å–è„šæœ¬çš„è¯·æ±‚ï¼Œç„¶åæ‰§è¡Œè„šæœ¬ã€‚</p>
<p>Once this process is done, the parsing can resume, and the rest of the HTML can be analyzed.</p>
<p>å®Œæˆæ­¤è¿›ç¨‹åå°±ç»§ç»­è§£æHTMLçš„å…¶ä½™éƒ¨åˆ†ã€‚</p>
<p>As you can imagine, this operation can have a huge impact on the loading time of the page.</p>
<p>å¯ä»¥æƒ³è±¡ï¼Œæ­¤æ“ä½œå¯ä»¥ä¼šå¯¹é¡µé¢åŠ è½½æ—¶é—´äº§ç”Ÿå·¨å¤§å½±å“ã€‚</p>
<p>If the script takes a little longer to load than expected, for example if the network is a bit slow or if youâ€™re on a mobile device and the connection is a bit sloppy, the visitor will likely see a blank page until the script is loaded and executed.</p>
<p>å¦‚æœè„šæœ¬åŠ è½½çš„æ—¶é—´è¶…å‡ºé¢„æœŸï¼ˆæ¯”å¦‚ç½‘é€Ÿæ…¢æˆ–è€…ä½¿ç”¨æ‰‹æœºè¿æ¥ä¸ç¨³å®šï¼‰ï¼Œåœ¨è„šæœ¬åŠ è½½å¹¶æ‰§è¡Œç»“æŸå‰å‘ˆçŒ®ç»™é¡µé¢è®¿é—®è€…çš„éƒ½æ˜¯ç©ºç™½é¡µé¢ã€‚</p>
<h2 id="ä½ç½®çš„é‡è¦æ€§"><a href="#ä½ç½®çš„é‡è¦æ€§" class="headerlink" title="ä½ç½®çš„é‡è¦æ€§"></a>ä½ç½®çš„é‡è¦æ€§</h2><p>When you first learn HTML, youâ€™re told script tags live in the <head><meta name="generator" content="Hexo 3.8.0"> tag:<br>åˆå­¦HTMLä¸€èˆ¬åœ¨headæ ‡ç­¾ä¸­æ·»åŠ è„šæœ¬ï¼Œå¦‚ä¸‹ï¼š<br><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Title<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"script.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    ...</span><br><span class="line">  <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure></head></p>
<p>As I told earlier, when the parser finds this line, it goes to fetch the script and executes it. Then, after itâ€™s done with this task, it goes on to parse the body.</p>
<p>å‰é¢æåˆ°ï¼Œæ¯å½“HTMLè§£æå™¨æ‰¾åˆ°è¯¥è¡Œæ—¶ï¼Œå°†å‘å‡ºä¸€ä¸ªè·å–è„šæœ¬çš„è¯·æ±‚å¹¶æ‰§è¡Œè„šæœ¬ã€‚ç»“æŸæ­¤ä»»åŠ¡åå°†ç»§ç»­è§£æé¡µé¢ä¸­çš„bodyéƒ¨åˆ†ã€‚</p>
<p>This is bad because there is a lot of delay introduced. A very common solution to this issue is to put the script tag to the bottom of the page, just before the closing  tag.</p>
<p>è¿™æ˜¯ä¸€ç§å¾ˆç³Ÿç³•çš„åšæ³•ï¼Œå› ä¸ºå®ƒä¼šäº§ç”Ÿè®¸å¤šå»¶è¿Ÿã€‚ä¸€ä¸ªå¸¸è§çš„è§£å†³æ–¹æ¡ˆæ˜¯å°†scriptæ ‡ç­¾æ”¾åˆ°é¡µé¢åº•éƒ¨ï¼ˆä¹Ÿå°±æ˜¯bodyç»“æŸæ ‡ç­¾å‰ï¼‰ã€‚</p>
<p>Doing so, the script is loaded and executed after all the page is already parsed and loaded, which is a huge improvement over the head alternative.</p>
<p>è¿™æ ·ï¼Œåœ¨è§£æå’ŒåŠ è½½æ‰€æœ‰é¡µé¢ä¹‹ååŠ è½½å¹¶æ‰§è¡Œè„šæœ¬ï¼Œæ˜¯å¯¹å¤´éƒ¨æ›¿ä»£æ–¹æ¡ˆçš„å·¨å¤§æ”¹è¿›ã€‚</p>
<p>This is the best thing you can do, if you need to support older browsers that do not support two relatively recent features of HTML: async and defer.</p>
<p>å¦‚æœä½ éœ€è¦æ”¯æŒä¸æ”¯æŒä¸¤ç§ç›¸å¯¹è¾ƒæ–°çš„HTMLç‰¹æ€§çš„æ—§æµè§ˆå™¨ï¼Œé‚£ä¹ˆasync(å¼‚æ­¥)å’Œdefer(å»¶è¿Ÿ)æ˜¯ä½ çš„æœ€ä½³è§£å†³æ–¹æ¡ˆã€‚</p>
<h2 id="Async-å’Œ-Defer"><a href="#Async-å’Œ-Defer" class="headerlink" title="Async å’Œ Defer"></a>Async å’Œ Defer</h2><p>Both async and defer are boolean attributes. Their usage is similar:</p>
<p>asyncå’Œdefertéƒ½æ˜¯ç±»å‹ä¸ºå¸ƒå°”å€¼çš„å±æ€§ï¼Œå®ƒä»¬çš„ç”¨æ³•å¾ˆç›¸ä¼¼ï¼š<br><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">async</span> <span class="attr">src</span>=<span class="string">"script.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure></p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">defer</span> <span class="attr">src</span>=<span class="string">"script.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>if you specify both, async takes precedence on modern browsers, while older browsers that support defer but not async will fallback to defer.</p>
<p>å¦‚æœåŒæ—¶ä½¿ç”¨ä¸¤ä¸ªå±æ€§ï¼Œasyncåˆ™åœ¨ç°ä»£æµè§ˆå™¨ä¼˜å…ˆä½¿ç”¨ï¼Œè€Œæ”¯æŒdeferè€Œä¸æ”¯æŒasyncçš„æ—§æµè§ˆå™¨å°†é€€å›ä¸ºdeferã€‚</p>
<p>These attributes make only sense when using the script in the head portion of the page, and they are useless if you put the script in the body footer like we saw above.</p>
<p>è¿™ä¸¤ç§å±æ€§åªåœ¨æˆ‘ä»¬å°†scriptæ ‡ç­¾æ”¾åœ¨é¡µé¢headæ ‡ç­¾ä¸­æ—¶èµ·ä½œç”¨ï¼Œæ”¾åœ¨é¡µè„šä¸­æ˜¯æ— æ•ˆçš„ã€‚</p>
<h2 id="æ€§èƒ½å¯¹æ¯”"><a href="#æ€§èƒ½å¯¹æ¯”" class="headerlink" title="æ€§èƒ½å¯¹æ¯”"></a>æ€§èƒ½å¯¹æ¯”</h2><h3 id="headä¸­æ— asyncå’Œdeferæ—¶"><a href="#headä¸­æ— asyncå’Œdeferæ—¶" class="headerlink" title="headä¸­æ— asyncå’Œdeferæ—¶"></a>headä¸­æ— asyncå’Œdeferæ—¶</h3><p>Hereâ€™s how a page loads a script without neither defer or async, put in the head portion of the page:</p>
<p>ä¸‹å›¾ä¸ºé¡µé¢ä¸­æ²¡æœ‰deferæˆ–asyncï¼Œå¹¶ä¸”å°†è„šæœ¬æ”¾åœ¨headæ ‡ç­¾ä¸­æ—¶åŠ è½½é¡µé¢çš„æ•ˆæœï¼š</p>
<p><img src="https://ws3.sinaimg.cn/large/005BYqpgly1g1jjbf73s0j30vh06wgll.jpg" alt="text"></p>
<p>The parsing is paused until the script is fetched, and executed. Once this is done, parsing resumes.</p>
<p>é¡µé¢è§£æåœ¨è¯·æ±‚åˆ°è„šæœ¬æ—¶æš‚åœï¼Œç„¶åæ‰§è¡Œè„šæœ¬ã€‚æ‰§è¡Œç»“æŸåï¼Œè§£æç»§ç»­æ‰§è¡Œã€‚</p>
<h3 id="bodyä¸­æ— asyncå’Œdeferæ—¶"><a href="#bodyä¸­æ— asyncå’Œdeferæ—¶" class="headerlink" title="bodyä¸­æ— asyncå’Œdeferæ—¶"></a>bodyä¸­æ— asyncå’Œdeferæ—¶</h3><p>Hereâ€™s how a page loads a script without neither defer or async, put at the end of the body tag, just before it closes:</p>
<p>ä¸‹å›¾ä¸ºé¡µé¢ä¸­æ²¡æœ‰deferæˆ–asyncï¼Œå¹¶ä¸”å°†è„šæœ¬æ”¾åœ¨bodyç»“æŸæ ‡ç­¾å‰æ—¶åŠ è½½é¡µé¢çš„æ•ˆæœï¼š</p>
<p><img src="https://ws3.sinaimg.cn/large/005BYqpgly1g1jjbf73s0j30vh06wgll.jpg" alt="text"></p>
<p>The parsing is done without any pauses, and when it finishes, the script is fetched, and executed. Parsing is done before the script is even downloaded, so the page appears to the user way before the previous example.</p>
<p>è§£æåœ¨æ²¡æœ‰ä»»ä½•æš‚åœçš„æƒ…å†µä¸‹å®Œæˆæ—¶ï¼Œè·å–è„šæœ¬å¹¶æ‰§è¡Œã€‚ç”šè‡³åœ¨ä¸‹è½½è„šæœ¬ä¹‹å‰å°±å·²ç»å®Œæˆäº†è§£æï¼Œæ‰€ä»¥ç”¨æˆ·å¯ä»¥æ¯”å‰é¢çš„ç¤ºä¾‹æ›´æ—©çœ‹åˆ°é¡µé¢ã€‚</p>
<h3 id="headä¸­æœ‰asyncæ—¶"><a href="#headä¸­æœ‰asyncæ—¶" class="headerlink" title="headä¸­æœ‰asyncæ—¶"></a>headä¸­æœ‰asyncæ—¶</h3><p>Hereâ€™s how a page loads a script with async, put in the head tag:</p>
<p>ä¸‹å›¾ä¸ºå°†å¸¦æœ‰asyncå±æ€§çš„è„šæœ¬æ ‡ç­¾æ”¾åœ¨headæ ‡ç­¾æ—¶é¡µé¢åŠ è½½çš„æ•ˆæœï¼š</p>
<p><img src="https://ws3.sinaimg.cn/large/005BYqpgly1g1jjprl8bij30vg06v0sp.jpg" alt="text"></p>
<p>The script is fetched asynchronously, and when itâ€™s ready the HTML parsing is paused to execute the script, then itâ€™s resumed.</p>
<p>å¼‚æ­¥è·å–è„šæœ¬ï¼Œå½“å®ƒå‡†å¤‡å¥½æ‰§è¡Œè„šæœ¬æ—¶ï¼Œå°†æš‚åœè§£æHTMLï¼Œå¼€å§‹æ‰§è¡Œè„šæœ¬ï¼Œè„šæœ¬æ‰§è¡Œç»“æŸåé‡æ–°å¼€å§‹è§£æHTMLã€‚</p>
<h3 id="headeä¸­æœ‰deferæ—¶"><a href="#headeä¸­æœ‰deferæ—¶" class="headerlink" title="headeä¸­æœ‰deferæ—¶"></a>headeä¸­æœ‰deferæ—¶</h3><p>Hereâ€™s how a page loads a script with defer, put in the head tag:</p>
<p>ä¸‹å›¾ä¸ºå°†å¸¦æœ‰deferå±æ€§çš„è„šæœ¬æ ‡ç­¾æ”¾åœ¨headæ ‡ç­¾æ—¶é¡µé¢åŠ è½½çš„æ•ˆæœï¼š</p>
<p><img src="https://ws3.sinaimg.cn/large/005BYqpgly1g1jk0cqyorj30vh06z0so.jpg" alt="text"></p>
<p>The script is fetched asynchronously, and itâ€™s executed only after the HTML parsing is done.</p>
<p>è„šæœ¬é€šè¿‡å¼‚æ­¥æ–¹å¼è·å–ï¼Œå¹¶ä¸”åœ¨HTMLè§£æå®Œæˆåæ‰å¼€å§‹æ‰§è¡Œã€‚</p>
<p>Parsing finishes just like when we put the script at the end of the body tag, but overall the script execution finishes well before, because the script has been downloaded in parallel with the HTML parsing.</p>
<p>è§£æå®Œæˆå°±åƒæˆ‘ä»¬å°†è„šæœ¬æ”¾åœ¨bodyæ ‡è®°çš„æœ«å°¾ä¸€æ ·ï¼Œä½†æ€»ä½“æ¥è¯´è„šæœ¬æ‰§è¡Œå†æ¬¡ä¹‹å‰å®Œæˆæ›´å¥½ï¼Œå› ä¸ºä¸‹è½½è„šæœ¬ä¸HTMLè§£æå¹¶è¡Œè¿›è¡Œã€‚</p>
<p>So this is the winning solution in terms of speed ğŸ†</p>
<p>æ‰€ä»¥è¿™å°±æ˜¯é€Ÿåº¦æ–¹é¢çš„æœ€ä½³è§£å†³æ–¹æ¡ˆ ğŸ†</p>
<h3 id="é˜»å¡è§£æ"><a href="#é˜»å¡è§£æ" class="headerlink" title="é˜»å¡è§£æ"></a>é˜»å¡è§£æ</h3><p>async blocks the parsing of the page while defer does not.</p>
<p>asyncä¼šé˜»å¡é¡µé¢è§£æï¼Œè€Œdeferä¸ä¼šã€‚</p>
<h3 id="é˜»å¡æ¸²æŸ“"><a href="#é˜»å¡æ¸²æŸ“" class="headerlink" title="é˜»å¡æ¸²æŸ“"></a>é˜»å¡æ¸²æŸ“</h3><p>Neither async nor defer guarantee anything on blocking rendering. This is up to you and your script (for example, making sure your scripts run after the onLoad) event.</p>
<p>asyncå’Œdeferéƒ½ä¸ä¿è¯é˜»æ­¢é¡µé¢æ¸²æŸ“ã€‚è¿™å–å†³äºä½ å’Œä½ çš„è„šæœ¬ï¼ˆå¦‚ï¼šç¡®ä¿ä½ çš„è„šæœ¬åœ¨onLoadä¹‹åè¿è¡Œï¼‰äº‹ä»¶ã€‚</p>
<h3 id="domInteractive"><a href="#domInteractive" class="headerlink" title="domInteractive"></a>domInteractive</h3><p>Scripts marked defer are executed right after the domInteractive event, which happens after the HTML is loaded, parsed and the DOM is built.</p>
<p>æ ‡è®°ä¸ºdeferçš„è„šæœ¬åœ¨domInteractiveäº‹ä»¶ä¹‹åç«‹å³æ‰§è¡Œï¼Œè¿™å‘ç”Ÿåœ¨åŠ è½½ã€è§£æå®ŒæˆHTMLå¹¶ä¸”æ„å»ºDOMä¹‹åã€‚</p>
<p>CSS and images at this point are still to be parsed and loaded.</p>
<p>æ­¤æ—¶çš„CSSå’Œå›¾åƒä»ç„¶éœ€è¦è§£æå’ŒåŠ è½½ã€‚</p>
<p>Once this is done, the browser will emit the domComplete event, and then onLoad.</p>
<p>åŠ è½½ç»“æŸåï¼Œæµè§ˆå™¨ä¼šè§¦å‘domCompleteäº‹ä»¶ï¼Œç„¶åæ˜¯onLoadäº‹ä»¶ã€‚</p>
<p>domInteractive is important because its timing is recognized as a measure of perceived loading speed. See the MDN for more.</p>
<p>domInteractiveå¾ˆé‡è¦ï¼Œå› ä¸ºå®ƒçš„æ—¶é—´è¢«è®¤ä¸ºæ˜¯æ„ŸçŸ¥åŠ è½½é€Ÿåº¦çš„é‡åº¦ã€‚æ›´å¤šä¿¡æ¯è¯·å‚é˜…<a href="https://developer.mozilla.org/en-US/docs/Web/API/PerformanceTiming/domInteractive" target="_blank" rel="noopener">MDN</a>ã€‚</p>
<h2 id="ä¿æŒé¡ºåº"><a href="#ä¿æŒé¡ºåº" class="headerlink" title="ä¿æŒé¡ºåº"></a>ä¿æŒé¡ºåº</h2><p>Another case pro defer: scripts marked async are executed in casual order, when they become available. Scripts marked defer are executed (after parsing completes) in the order which they are defined in the markup.</p>
<p>æ ‡è®°ä¸ºasyncçš„è„šæœ¬æŒ‰åŠ è½½å®Œçš„é¡ºåºæ‰§è¡Œã€‚æ ‡è®°ä¸ºdeferçš„è„šæœ¬æŒ‰å®šä¹‰çš„é¡ºåºæ‰§è¡Œï¼ˆåœ¨è§£æå®Œæˆä¹‹åï¼‰ã€‚</p>
<h2 id="è¯·ç›´æ¥å‘Šè¯‰æˆ‘æœ€ä¼˜è§£"><a href="#è¯·ç›´æ¥å‘Šè¯‰æˆ‘æœ€ä¼˜è§£" class="headerlink" title="è¯·ç›´æ¥å‘Šè¯‰æˆ‘æœ€ä¼˜è§£"></a>è¯·ç›´æ¥å‘Šè¯‰æˆ‘æœ€ä¼˜è§£</h2><p>The best thing to do to speed up your page loading when using scripts is to put them in the head, and add a defer attribute to your script tag:</p>
<p>ä½¿ç”¨è„šæœ¬æ—¶ï¼Œä¸ºé¡µé¢åŠ è½½æé€Ÿçš„æœ€ä½³æ–¹å¼æ˜¯å°†è„šæœ¬æ”¾åœ¨headæ ‡ç­¾ä¸­ï¼Œå¹¶ä¸”æ·»åŠ deferå±æ€§ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;script defer src=<span class="string">"script.js"</span>&gt;<span class="xml"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br></pre></td></tr></table></figure>
<p>This is the scenario that triggers the faster domInteractive event.</p>
<p>è¿™æ˜¯æ›´å¿«è§¦å‘domInteractiveæ—¶é—´çš„åœºæ™¯ã€‚</p>
<p>Considering the pros of defer, is seems a better choice over async in a variety of scenarios.</p>
<p>è€ƒè™‘åˆ°deferçš„ä¼˜ç‚¹ï¼Œåœ¨å„ç§åœºæ™¯çœ‹èµ·æ¥éƒ½æ¯”asyncæ›´å¥½ã€‚</p>
<p>Unless you are fine with delaying the first render of the page, making sure that when the page is parsed the JavaScript you want is already executed.</p>
<p>é™¤éä½ æƒ³è¦å»¶è¿Ÿé¡µé¢çš„é¦–æ¬¡æ¸²æŸ“ï¼Œå¦åˆ™ç¡®ä¿åœ¨è§£æé¡µé¢æ—¶ä½ å·²ç»æ‰§è¡Œäº†æ‰€éœ€çš„JavaScriptã€‚</p>
<blockquote>
<p>æœ€åæ”¾ä¸ª<a href="https://flaviocopes.com/javascript-async-defer/#the-position-matters" target="_blank" rel="noopener">åŸæ–‡é“¾æ¥</a>byeğŸ‘‹~</p>
</blockquote>

      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      
      
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2019/03/18/css-sum/" rel="next" title="CSSå°è®°å½•â€”â€”æŒç»­æ›´æ–°">
                <i class="fa fa-chevron-left"></i> CSSå°è®°å½•â€”â€”æŒç»­æ›´æ–°
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2019/03/29/prototype/" rel="prev" title="é‡å­¦JSç³»åˆ— â€”â€”â€”â€” åŸå‹">
                é‡å­¦JSç³»åˆ— â€”â€”â€”â€” åŸå‹ <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </div>
  
  
  
  </article>



    <div class="post-spread">
      
    </div>
  </div>


          </div>
          


          

  
    <div class="comments" id="comments">
    </div>
  



        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">
            Table of Contents
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview-wrap">
            Overview
          </li>
        </ul>
      

      <section class="site-overview-wrap sidebar-panel">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <img class="site-author-image" itemprop="image"
                src="https://avatars0.githubusercontent.com/u/32869438?s=460&v=4"
                alt="onion" />
            
              <p class="site-author-name" itemprop="name">onion</p>
              <p class="site-description motion-element" itemprop="description"></p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/">
              
                  <span class="site-state-item-count">20</span>
                  <span class="site-state-item-name">posts</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-categories">
                <a href="/categories/index.html">
                  <span class="site-state-item-count">5</span>
                  <span class="site-state-item-name">categories</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-tags">
                <a href="/tags/index.html">
                  <span class="site-state-item-count">14</span>
                  <span class="site-state-item-name">tags</span>
                </a>
              </div>
            

          </nav>

          

          
            <div class="links-of-author motion-element">
                
                  <span class="links-of-author-item">
                    <a href="https://github.com/ONION-ZX" target="_blank" title="GitHub">
                      
                        <i class="fa fa-fw fa-github"></i>GitHub</a>
                  </span>
                
                  <span class="links-of-author-item">
                    <a href="zxonion@gmail.com" target="_blank" title="E-Mail">
                      
                        <i class="fa fa-fw fa-envelope"></i>E-Mail</a>
                  </span>
                
            </div>
          

          
          

          
          

          

        </div>
      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#ä½ç½®çš„é‡è¦æ€§"><span class="nav-number">1.</span> <span class="nav-text">ä½ç½®çš„é‡è¦æ€§</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Async-å’Œ-Defer"><span class="nav-number">2.</span> <span class="nav-text">Async å’Œ Defer</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#æ€§èƒ½å¯¹æ¯”"><span class="nav-number">3.</span> <span class="nav-text">æ€§èƒ½å¯¹æ¯”</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#headä¸­æ— asyncå’Œdeferæ—¶"><span class="nav-number">3.1.</span> <span class="nav-text">headä¸­æ— asyncå’Œdeferæ—¶</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#bodyä¸­æ— asyncå’Œdeferæ—¶"><span class="nav-number">3.2.</span> <span class="nav-text">bodyä¸­æ— asyncå’Œdeferæ—¶</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#headä¸­æœ‰asyncæ—¶"><span class="nav-number">3.3.</span> <span class="nav-text">headä¸­æœ‰asyncæ—¶</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#headeä¸­æœ‰deferæ—¶"><span class="nav-number">3.4.</span> <span class="nav-text">headeä¸­æœ‰deferæ—¶</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#é˜»å¡è§£æ"><span class="nav-number">3.5.</span> <span class="nav-text">é˜»å¡è§£æ</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#é˜»å¡æ¸²æŸ“"><span class="nav-number">3.6.</span> <span class="nav-text">é˜»å¡æ¸²æŸ“</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#domInteractive"><span class="nav-number">3.7.</span> <span class="nav-text">domInteractive</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#ä¿æŒé¡ºåº"><span class="nav-number">4.</span> <span class="nav-text">ä¿æŒé¡ºåº</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#è¯·ç›´æ¥å‘Šè¯‰æˆ‘æœ€ä¼˜è§£"><span class="nav-number">5.</span> <span class="nav-text">è¯·ç›´æ¥å‘Šè¯‰æˆ‘æœ€ä¼˜è§£</span></a></li></ol></div>
            

          </div>
        </section>
      <!--/noindex-->
      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <script async src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js">
</script>
<div class="copyright">&copy; <span itemprop="copyrightYear">2019</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">onion</span>

  
</div>






  <div class="theme-info">Theme &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Pisces</a> v5.1.4</div>





    <script async src="//dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script>

    <span id="busuanzi_container_site_pv">æ€»è®¿é—®é‡<span id="busuanzi_value_site_pv"></span>æ¬¡</span>
    <span class="post-meta-divider">|</span>
    <span id="busuanzi_container_site_uv">æ€»è®¿å®¢<span id="busuanzi_value_site_uv"></span>äºº</span>
    <span class="post-meta-divider">|</span>



        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
          <span id="scrollpercent"><span>0</span>%</span>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.1.4"></script>



  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.4"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.4"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script>



  


  




	





  





  










  <script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script>
  <script src="//unpkg.com/valine/dist/Valine.min.js"></script>
  
  <script type="text/javascript">
    var GUEST = ['nick','mail','link'];
    var guest = 'nick,mail,link';
    guest = guest.split(',').filter(item=>{
      return GUEST.indexOf(item)>-1;
    });
    new Valine({
        el: '#comments' ,
        verify: false,
        notify: false,
        appId: 'EVNiUd7DVr6kGsFPOIB78qfI-gzGzoHsz',
        appKey: '9359Xc0nhmnoPjb60W4gO89L',
        placeholder: 'Just say something',
        avatar:'https://ws3.sinaimg.cn/large/005BYqpgly1g1003mayd2j30zk0k0q4c.jpg',
        guest_info:guest,
        pageSize:'10' || 10,
    });
  </script>



  





  

  

  

  
  

  

  

  

<script type="text/javascript" src="/js/src/love.js"></script>



</body>
</html>
